<!-- if user is looged-in: display user's avatar and user menu -->
@if (isLoggedIn$ | async) {
<button mat-button [matMenuTriggerFor]="userMenu" class="main-toolbar-button user-menu" data-cy="user-button">
  <img appAdminImage [image]="(user$ | async)?.email" [type]="'user'" class="avatar" alt="avatar" />
</button>

} @else {
<button mat-raised-button color="primary" [matMenuTriggerFor]="loginForm" class="login-button" data-cy="login-button">
  {{ 'pages.userSettings.userMenu.login' | translate }}
</button>
}
<mat-menu #loginForm xPosition="before" class="form-menu">
  <app-login-form (click)="$event.stopPropagation()" (keydown)="$event.stopPropagation()" />
</mat-menu>

<mat-menu #userMenu="matMenu" xPosition="before" class="user-menu">
  <div class="menu-header">
    <div class="menu-title">{{ 'pages.userSettings.userMenu.signedInAs' | translate }}</div>
    <div class="menu-title">{{ (user$ | async)?.givenName }} {{ (user$ | async)?.familyName }}</div>
  </div>

  <a mat-menu-item [routerLink]="['/', 'my-profile', 'account']">
    {{ 'pages.userSettings.userMenu.myAccount' | translate }}
  </a>

  @if (isSysAdmin$ | async) {
  <a mat-menu-item [routerLink]="['/', systemLink]">
    {{ 'pages.userSettings.userMenu.systemAdministration' | translate }}
  </a>
  }

  <mat-divider />

  <button mat-menu-item (click)="logout()">{{ 'pages.userSettings.userMenu.logout' | translate }}</button>
</mat-menu>

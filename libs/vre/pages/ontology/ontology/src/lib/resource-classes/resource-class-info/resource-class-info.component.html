<mat-card
  (mouseenter)="classHovered = true"
  (mouseleave)="classHovered = false"
  data-cy="class-card"
  appearance="outlined"
  cdkDrag
  cdkDragBoundary=".drag-drop-stop">
  <mat-card-header cdkDragHandle>
    <div style="flex: 1">
      <mat-card-title [matTooltip]="this.resourceClass.comments | appStringifyStringLiteral" matTooltipPosition="above">
        {{ this.resourceClass.labels | appStringifyStringLiteral | appTruncate: 56 }}
      </mat-card-title>
      <mat-card-subtitle>
        <span class="mat-caption">
          <span> {{ resourceClass.name }} </span>
          <span>&nbsp;&middot;&nbsp;</span>
          <span data-cy="class-type-label"
            >@if (resourceClass.defaultClassIcon) {
            <mat-icon
              style="width: 14px; height: 14px; font-size: 14px; line-height: 14px; position: relative; top: 2px"
              >{{ resourceClass.defaultClassIcon }}</mat-icon
            >
            } {{ resourceClass.defaultClassLabel }}
          </span>
        </span>
      </mat-card-subtitle>
    </div>
    <span>
      @if ((project$ | async)?.status) {
      <span>
        @if (classHovered || menuOpen) {
        <button
          mat-icon-button
          [matMenuTriggerFor]="resClassMenu"
          data-cy="more-button"
          (menuOpened)="menuOpen = true"
          (menuClosed)="menuOpen = false"
          (click)="setCanBeDeleted()">
          <mat-icon>more_vert</mat-icon>
        </button>
        }
      </span>
      }
      <span
        [matTooltip]="
          expandClasses
            ? (_translate.instant('pages.ontology.resourceClassInfo.collapse'))
            : (_translate.instant('pages.ontology.resourceClassInfo.expand'))
        ">
        <button mat-icon-button (click)="expandClasses = !expandClasses">
          <mat-icon>{{ expandClasses ? "expand_less" : "expand_more" }}</mat-icon>
        </button>
      </span>
    </span>
  </mat-card-header>
  <!-- resource class card content with list of properties -->
  @if (expandClasses) {
  <mat-card-content>
    @if (resourceClass.properties?.length) {
    <mat-list cdkDropList (cdkDropListDropped)="onPropertyDropped($event)">
      @for (prop of resourceClass.properties; track trackByPropToDisplayFn(i, prop); let i = $index) {
      <app-property-item [classProp]="prop" (cardinalityChange)="onCardinalityChange($event)" />
      }
    </mat-list>
    } @else {
    <p>{{ 'pages.ontology.resourceClassInfo.noProperties' | translate }}</p>
    } @if ((hasProjectAdminRights$ | async)) {
    <app-add-property-menu [resourceClass]="resourceClass" />
    }
  </mat-card-content>
  }
</mat-card>

<mat-menu #resClassMenu="matMenu" xPosition="before">
  @if ((hasProjectAdminRights$ | async) === true && (project$ | async)?.status === true) {
  <button mat-menu-item data-cy="edit-button" (click)="editResourceClassInfo()">
    <mat-icon>edit</mat-icon>
    {{ 'pages.ontology.resourceClassInfo.edit' | translate }}
  </button>
  }
  <button
    mat-menu-item
    (click)="openInDatabrowser()"
    [disabled]="classCanBeDeleted"
    data-cy="open-in-databrowser-button">
    <mat-icon>open_in_new</mat-icon>
    {{ 'pages.ontology.resourceClassInfo.openInstances' | translate }}
  </button>
  <button mat-menu-item (click)="copyResourceClassId()" data-cy="copy-id-button">
    <mat-icon>content_copy</mat-icon>
    {{ 'pages.ontology.resourceClassInfo.copyId' | translate }}
  </button>
  @if ((hasProjectAdminRights$ | async) === true && (project$ | async)?.status === true) {
  <button
    [matTooltip]="
      classCanBeDeleted ? '' : _translate.instant('pages.ontology.resourceClassInfo.cannotDelete')
    "
    matTooltipPosition="before"
    [disabled]="!classCanBeDeleted"
    (click)="deleteResourceClass()"
    mat-menu-item
    data-cy="delete-button">
    <mat-icon>delete</mat-icon>
    {{ 'pages.ontology.resourceClassInfo.delete' | translate }}
  </button>
  }
</mat-menu>

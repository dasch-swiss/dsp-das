<button
  mat-button
  mat-stroked-button
  cdkOverlayOrigin
  #trigger="cdkOverlayOrigin"
  color="primary"
  [disabled]="orderByDisabled$ | async"
  (click)="isOpen = !isOpen">
  <p class="label-icon-container">
    <span class="label">Order by</span>
    <span class="icon">
      <mat-icon>expand_more</mat-icon>
    </span>
  </p>
</button>
<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayOpen]="isOpen"
  [cdkConnectedOverlayHasBackdrop]="true"
  [cdkConnectedOverlayBackdropClass]="[
            'cdk-overlay-transparent-backdrop'
        ]"
  (backdropClick)="isOpen = false">
  <mat-selection-list
    #sortOrderSelectionList
    cdkDropList
    class="sort-list"
    (cdkDropListDropped)="drop($event)"
    (selectionChange)="onSelectionChange($event)">
    @for (item of orderByItems$ | async; track item.id) {
    <mat-list-option
      class="sort-item"
      [selected]="item.orderBy"
      [value]="item.id"
      [disabled]="item.disabled"
      [matTooltip]="TOOLTIP_TEXT"
      [matTooltipDisabled]="!item.disabled"
      cdkDrag>
      <span cdkDragHandle matListItemIcon class="drag-handle">
        <mat-icon>drag_indicator</mat-icon>
      </span>
      <span matListItemTitle> {{ item.label }} </span>
    </mat-list-option>
    }
  </mat-selection-list>
</ng-template>

<app-dialog-header [title]="title" [subtitle]="'Link resources'"></app-dialog-header>

<mat-dialog-content>
  <form
    [formGroup]="form"
    class="form"
    *ngIf="((isSysAdmin$ | async) === true) || ((usersProjects$ | async)?.length && (isCurrentProjectAdminOrSysAdmin$ | async) === true); else notProjectMember">
    <app-select-project
      matTooltip="The link resource has to be added to a project. Please select one of yours."
      [matTooltipPosition]="'above'"
      [formGroup]="form"
      [usersProjects]="usersProjects$ | async"
      (projectSelected)="selectedProject = $event">
    </app-select-project>

    <app-common-input [control]="form.controls.label" label="Collection label" />

    <app-ck-editor-control [control]="form.controls['comment']" [label]="'Comment'" />

    <div class="resource-container">
      <p>The following resources will be connected:</p>
      <ul>
        <li *ngFor="let res of data.resources.resInfo; trackBy: trackByFn">{{ res.label }}</li>
      </ul>
    </div>
  </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button type="button" (click)="dialogRef.close()">{{ 'form.action.cancel' | translate }}</button>

  <button
    mat-raised-button
    color="primary"
    appLoadingButton
    [isLoading]="isLoading$ | async"
    [disabled]="form.invalid"
    (click)="submitData()">
    {{ 'form.action.submit' | translate }}
  </button>
</mat-dialog-actions>

<ng-template #notProjectMember>
  You have to be a member in at least one project to link the selected resources.
</ng-template>

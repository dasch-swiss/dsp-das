<form
  [formGroup]="form"
  (ngSubmit)="submitData()"
  *ngIf="((isSysAdmin$ | async) === true) || ((usersProjects$ | async)?.length && (isCurrentProjectAdminOrSysAdmin$ | async) === true); else notProjectMember">
  <mat-form-field>
    <mat-label>Select a project</mat-label>
    <mat-select placeholder="Select a project" [formControl]="form.controls.project">
      <mat-option *ngFor="let project of usersProjects$ | async" [value]="project.id">
        {{ project.shortcode }} | {{ project.shortname }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="form.controls.project.touched && form.controls.project.errors as errors"
      >{{ errors | humanReadableError }}
    </mat-error>
  </mat-form-field>

  <app-common-input [control]="form.controls.label" [label]="'Collection label'" />
  <app-ck-editor-control [control]="form.controls.comment" [label]="'Comment'" />

  <div>
    <p>The following resources will be connected:</p>
    <ul>
      <li *ngFor="let res of resources.resInfo; trackBy: trackByFn">{{ res.label }}</li>
    </ul>
  </div>

  <div style="display: flex; justify-content: space-between">
    <button mat-button (click)="closeDialog.emit()">{{ 'form.action.cancel' | translate }}</button>

    <button
      mat-raised-button
      type="submit"
      [color]="(hasLoadingErrors$ | async) ? 'warn' : 'primary'"
      appLoadingButton
      [isLoading]="isLoading$ | async"
      [disabled]="form.invalid">
      {{ 'form.action.save' | translate }}
    </button>
  </div>
</form>

<ng-template #notProjectMember>
  You have to be a member in at least one project to link the selected resources.
</ng-template>

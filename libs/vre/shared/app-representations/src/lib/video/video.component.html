<div appDisableContextMenu [class.cinema]="cinemaMode">
  <app-status [comment]="videoError" [url]="src.fileValue.fileUrl" [representation]="'video'" *ngIf="videoError" />

  <div style="margin-bottom: -4px" class="video-container">
    <video
      style="width: 100%"
      #videoEle
      id="video"
      *ngIf="video; else loading"
      [src]="video"
      type="video/mp4"
      preload="auto"
      [muted]="false"
      (canplay)="onVideoPlayerReady()"
      (click)="videoPlayer.togglePlay()"
      (timeupdate)="timeUpdate()"
      (loadedmetadata)="loadedMetadata()"
      (canplaythrough)="loadedVideo()"
      (error)="handleVideoError($event)"></video>
    <app-video-overlay *ngIf="false" />
  </div>

  <div class="preview" #preview>
    <app-video-preview [src]="src" [time]="previewTime" [fileInfo]="fileInfo" (loaded)="displayPreview(!$event)" />
  </div>

  <mat-toolbar *ngIf="false">
    <mat-toolbar-row>
      <app-av-timeline
        #timeline
        [value]="currentTime"
        [min]="0"
        [max]="duration"
        [resized]="cinemaMode"
        (move)="updatePreview($event)"
        (mouseenter)="displayPreview(true)"
        (dimension)="timelineDimension = $event"
        (mouseleave)="displayPreview(false)"
        (changed)="videoPlayer.navigate($event)"
        [disabled]="!videoEle" />
    </mat-toolbar-row>
  </mat-toolbar>
  <app-video-toolbar
    *ngIf="fileInfo"
    [src]="src"
    [parentResource]="parentResource"
    [fileInfo]="fileInfo"
    [(cinemaMode)]="cinemaMode" />
</div>

<app-segments-display
  *ngIf="segmentsService.segments.length > 0 && duration > 0"
  [segments]="segmentsService.segments"
  [videoLengthSecs]="duration" />

<ng-template #loading>
  <dasch-swiss-app-progress-indicator />
</ng-template>
